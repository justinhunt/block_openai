{"version":3,"file":"ajaxhelper.min.js","sources":["../src/ajaxhelper.js"],"sourcesContent":["/**\n * a helper to manage ajax openai calls\n *\n * @module     block_openai/ajaxhelper\n * @class      ajaxhelper\n * @package    block_openai\n * @copyright  2023 Justin Hunt <poodllsupport@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/log','core/ajax'],\n    function($, log, Ajax) {\n\n        \"use strict\"; // jshint ;_;\n\n        log.debug('ajax helper: initialising');\n\n        return {\n            //pass in config, the jquery video/audio object, and a function to be called when conversion has finshed\n            init: function (props) {\n                this.registerEvents();\n\n            },\n\n            registerEvents: function(){\n                //$('.writemodelanswer').on('click',function() {\n                $('.btn.btn-secondary.ml-0').on('click',function() {\nlog.debug('clicked')\n                    var unitindex = $(this).data('unitindex');\n                    var topic = $('input[name=\"dquestionid[' + unitindex + ']\"]:checked').parent().text();\n                    switch($(this).data('targetfield')){\n                        case \"solomodelanswer\":\n                            var prompt = $('#id_prompts_' + unitindex + '  option:selected').text();\n                            var topicresponse = $('#id_solomodelanswer_' + unitindex);\n                            //push results to server\n                            Ajax.call([{\n                                methodname: 'block_openai_fetch_completion',\n                                args: {\n                                    completiontask: 'basicchat',\n                                    taskparam1: prompt,\n                                    taskparam2: topic,\n                                    taskparam3: 'empty',\n                                    taskparam4: 'empty',\n                                }\n                            }])[0].then(function(resp){\n                                    topicresponse.text(resp);\n                                    //write value of ret to text area\n                                    log.debug(resp);\n                                }\n                            );\n                            break;\n                        case \"solokeywords\":\n                            var keywordresponse = $('#id_solokeywords_' + unitindex);\n                            Ajax.call([{\n                                methodname: 'block_openai_fetch_completion',\n                                args: {\n                                    completiontask: 'basicchat',\n                                    taskparam1: \"You are an ESL teaching assistant for making online course content.\",\n                                    taskparam2: \"Give me 5 - 7 words or phrases I could use to answer the following topic. Put each word or phrase on a new line with no introduction or numbering. Don't answer the topic. Just give me the words and phrases. The topic is: \" + topic,\n                                    taskparam3: 'empty',\n                                    taskparam4: 'empty',\n                                }\n                            }])[0].then(function(resp){\n                                    keywordresponse.text(resp);\n                                    //write value of ret to text area\n                                    log.debug(resp);\n                                }\n                            );\n                    }\n\n\n\n\n\n\n\n                });\n            }\n\n        };//end of return value\n    });"],"names":["define","$","log","Ajax","debug","init","props","registerEvents","on","unitindex","this","data","topic","parent","text","prompt","topicresponse","call","methodname","args","completiontask","taskparam1","taskparam2","taskparam3","taskparam4","then","resp","keywordresponse"],"mappings":";;;;;;;;;AASAA,iCAAO,CAAC,SAAU,WAAW,cACzB,SAASC,EAAGC,IAAKC,aAIbD,IAAIE,MAAM,6BAEH,CAEHC,KAAM,SAAUC,YACPC,kBAITA,eAAgB,WAEZN,EAAE,2BAA2BO,GAAG,SAAQ,WACxDN,IAAIE,MAAM,eACcK,UAAYR,EAAES,MAAMC,KAAK,aACzBC,MAAQX,EAAE,2BAA6BQ,UAAY,eAAeI,SAASC,cACxEb,EAAES,MAAMC,KAAK,oBACX,sBACGI,OAASd,EAAE,eAAiBQ,UAAY,qBAAqBK,OAC7DE,cAAgBf,EAAE,uBAAyBQ,WAE/CN,KAAKc,KAAK,CAAC,CACPC,WAAY,gCACZC,KAAM,CACFC,eAAgB,YAChBC,WAAYN,OACZO,WAAYV,MACZW,WAAY,QACZC,WAAY,YAEhB,GAAGC,MAAK,SAASC,MACbV,cAAcF,KAAKY,MAEnBxB,IAAIE,MAAMsB,mBAIjB,mBACGC,gBAAkB1B,EAAE,oBAAsBQ,WAC9CN,KAAKc,KAAK,CAAC,CACPC,WAAY,gCACZC,KAAM,CACFC,eAAgB,YAChBC,WAAY,sEACZC,WAAY,gOAAkOV,MAC9OW,WAAY,QACZC,WAAY,YAEhB,GAAGC,MAAK,SAASC,MACbC,gBAAgBb,KAAKY,MAErBxB,IAAIE,MAAMsB"}